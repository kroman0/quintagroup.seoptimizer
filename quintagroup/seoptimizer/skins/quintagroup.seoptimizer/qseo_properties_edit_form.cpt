<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="qseoptimizer">
  <metal:border fill-slot="top_slot">
    <tal:border define="dummy python:request.set('enable_border',1)" />
  </metal:border>
  <metal:style_head fill-slot="style_slot">
      <style type="text/css">
          tr.datagridwidget-empty-row {
              display:none;
          }
      </style>
  </metal:style_head>
  <metal:javascript_head fill-slot="javascript_head_slot">
      <script type="text/javascript"
              tal:condition="python:exists('portal/statistics.js')"
              tal:attributes="src string:${here/absolute_url}/statistics.js">
      </script>
      <script type="text/javascript"
              tal:condition="python:exists('portal/checkkeywords.js')"
              tal:attributes="src string:${here/absolute_url}/checkkeywords.js">
      </script>
      <script type="text/javascript"
              tal:condition="python:exists('portal/custommetatags.js')"
              tal:attributes="src string:${here/absolute_url}/custommetatags.js">
      </script>
  </metal:javascript_head>
  <body>
    <div metal:fill-slot="main"
         tal:define="errors options/state/getErrors;">
      <h1 i18n:translate="heading_edit_seo_properties">Edit SEO Properties</h1>
      <p i18n:translate="description_edit_seo_properties">
        This form allows you to edit html header meta tags that ape produced by 
        Plone CMS to incrase Search Engine visibility. The values generated by
        Plone are present as default values in input fields. To override default
        value, check corresponding checkbox and input value itself in 
        corresponding field.
      </p>
      <form name="edit_form"
            action=""
            method="post"
            tal:attributes="action string:${here/getId}/${template/getId}">
        <fieldset>
          <legend i18n:domain="plone" i18n:translate="legend_item_properties">
            Item Properties
          </legend>
          <div class="field">
            <label i18n:translate="label_page_title_tag" for="title">
              Page Title Tag
            </label>
            <div class="formHelp" i18n:translate="help_seo_title">
              Text to be present into &lt;TITLE&gt; tag. It is displayed in 
              browser title bar. Search engines display it as a title of the 
              document.
            </div>
            <input type="checkbox"
                   id="title_override"
                   name="title_override"
                   tabindex=""
                   tal:attributes="checked python:test(here.hasProperty('qSEO_title'), 'on', None);
                                   tabindex tabindex/next;"
                   />
            <label i18n:translate="label_override" for="title_override">
              Override
            </label>
            <input type="text"
                   id="seo_title"
                   name="title"
                   size="40"
                   value=""
                   tabindex=""
                   tal:attributes="value request/title | here/@@seo_context/seo_title;
                                   tabindex tabindex/next;"
                   />
          </div>
          <div class="field">
            <label i18n:translate="label_meta_description_tag" for="description">
              Meta Description Tag
            </label>
            <div class="formHelp" i18n:translate="help_seo_description">
              Description of the document to be displayed right below title
              in search engine results. It is indexed and considered to be
              more important then the page content by several SE.
            </div>
            <input type="checkbox"
                   id="description_override"
                   name="description_override"
                   tabindex=""
                   tal:attributes="checked python:test(here.hasProperty('qSEO_description'), 'on', None);
                                   tabindex tabindex/next;"
                   />
            <label i18n:translate="label_override" for="description_override">
              Override
            </label>
            <textarea 
                      type="text"
                      id="seo_description"
                      name="description"
                      rows="5"
                      cols="15"
                      tabindex=""
                      tal:attributes="tabindex tabindex/next;"
                      tal:content="request/description | here/@@seo_context/seo_description"
                      ></textarea>

          </div>
            
          <div class="field">
            <label i18n:translate="label_meta_keywords_tag" for="keywords">
              Meta Keywords Tag
            </label>
            <div class="formHelp" i18n:translate="help_seo_keywords">
              Keywords of the page to be indexed with. 
              <strong>Enter each keyword in separate line, please.</strong>
              Though the relevance of listing meta keywords is of 
              questionable value now it is useful to document what
              meta keywords you are focusing on for this page - for
              furture reference.
            </div>
            <input type="checkbox"
                   id="keywords_override"
                   name="keywords_override"
                   tabindex=""
                   tal:attributes="checked python:test(here.hasProperty('qSEO_keywords'), 'on', None);
                                   tabindex tabindex/next;"
                   />
            <label i18n:translate="label_override" for="keywords_override">
              Override
            </label>
            <textarea 
                      id="seo_keywords"
                      name="keywords:lines"
                      rows="11"
                      cols="15"
                      wrap="off"
                      tabindex=""
                      tal:attributes="tabindex tabindex/next;"
                      tal:define="keywords request/keywords | here/@@seo_context/seo_keywords"
                      tal:content="python:'\n'.join(keywords)"
                      ></textarea>
          </div>
          <div class="field">
            <label i18n:translate="label_html_comment" for="html_commment">
              HTML Comment
            </label>
            <div class="formHelp" i18n:translate="help_seo_html_comment">
              Comments embedded into HTML header.
            </div>
            <input type="checkbox"
                   id="html_comment_override"
                   name="html_comment_override"
                   tabindex=""
                   tal:attributes="checked python:test(here.hasProperty('qSEO_html_comment'), 'on', None);
                                   tabindex tabindex/next;"
                   />
            <label i18n:translate="label_override" for="html_comment_override">
              Override
            </label>
            <br />
            <textarea 
                      id="seo_html_comment"
                      name="html_comment"
                      rows="5"
                      cols="15"
                      tabindex=""
                      tal:attributes="tabindex tabindex/next;"
                      tal:content="request/html_comment | here/@@seo_context/seo_html_comment"
                      ></textarea>
          </div>
          <div class="field">
            <label i18n:translate="label_robot_tag" for="robots">
              Robot Tag
            </label>
            <div class="formHelp" i18n:translate="help_seo_robots">
              Robots meta tag value. Allows or denies indefing, following 
              links, etc. for spiders indexing your content.
            </div>
            <input type="checkbox"
                   id="robots_override"
                   name="robots_override"
                   tabindex=""
                   tal:attributes="checked python:test(here.hasProperty('qSEO_robots'), 'on', None);
                                   tabindex tabindex/next;"
                   />
            <label i18n:translate="label_override" for="robots_override">
              Override
            </label><br />
            <input type="text"
                   id="seo_robots"
                   name="robots"
                   size="25"
                   value=""
                   tabindex=""
                   tal:attributes="value request/robots | here/@@seo_context/seo_robots;
                                   tabindex tabindex/next;"
                   />
          </div>
          <div class="field">
            <label i18n:translate="label_distribution_tag" for="distribution">
              Distribution Tag
            </label>
            <div class="formHelp" i18n:translate="help_seo_distribution">
              Distribution meta tag to designate time and area disribution
              of the document.
            </div>
            <input type="checkbox"
                   id="distribution_override"
                   name="distribution_override"
                   tabindex=""
                   tal:attributes="checked python:test(here.hasProperty('qSEO_distribution'), 'on', None);
                                   tabindex tabindex/next;"
                   />
            <label i18n:translate="label_override" for="distribution_override">
              Override
            </label><br />
            <input type="text"
                   id="seo_distribution"
                   name="distribution"
                   size="25"
                   value=""
                   tabindex=""
                   tal:attributes="value request/distribution | here/@@seo_context/seo_distribution;
                                   tabindex tabindex/next;"
                   />
          </div>
          <div class="field"
               tal:define="fieldName string:custommetatags;">
            <label i18n:translate="label_custom_metatags" for="custom_metatags">
              Custom Meta Tags
            </label>
            <div class="formHelp" i18n:translate="help_seo_custommetatags">
              Here you can manage your custom meta tags.
            </div>
            <table class="custom-metatags-table"
                   id="datagridwidget-table-custommetatags"
                   style="width: 100%"
                   tal:define="columnNames python:['meta name', 'meta content'];
                               columnIds   python:['meta_name', 'meta_content'];
                               fielddata context/qSEO_CustomMetaTags|python:[];">
                <thead>
                    <tr>
                        <th class="discreet" style="text-align: left"
                            tal:repeat="columnName columnNames"
                            tal:content="columnName"
                            i18n:translate="">Column name</th>
                        <th />
                        <th />
                    </tr>
                </thead>
                <tbody id="datagridwidget-tbody-custommetatags">
                    <tal:row-loop tal:repeat="row fielddata">
                        <tr id="datagridwidget-row">
                            <tal:vars define="fieldId string:${fieldName}_${repeat/row/number}">
                                <td class="datagridwidget-cell"
                                    tal:repeat="column columnIds">
                                    <tal:cell tal:define="cell_value python:row.get(column);">
                                        <input type="text"
                                               id="columnId_fieldId"
                                               value=""
                                               name="fieldId.columnId:records"
                                               style="width: 100%;"
                                               tal:attributes="name string:${fieldName}.${column}:records;
                                                               id string:${column}_${fieldId};
                                                               value cell_value"/>
                                    </tal:cell>
                                </td>
                                <td  class="datagridwidget-manipulator">
                                    <img alt="Delete row"
                                         onclick="customMetaTagsFunctions.removeFieldRow(this);return false"
                                         tal:attributes="src string:${portal_url}/delete_icon.gif;" />
                                </td>
                                <td class="datagridwidget-hidden-data">
                                    <input type="hidden"
                                           tal:attributes="name string:${fieldName}.orderindex_:records;
                                                           id string:orderindex__${fieldId};
                                                           value repeat/row/number;" />
                                </td>
                            </tal:vars>
                        </tr>
                    </tal:row-loop>
                    <tr id="datagridwidget-empty-row"
                        class="datagridwidget-empty-row"
                        tal:define="fieldId string:${fieldName}_new">
                        <td class="datagridwidget-cell"
                            tal:repeat="column columnIds">
                            <span>
                                <input type="text"
                                       id="columnId_fieldName_new"
                                       value=""
                                       name="fieldName.columnId:records"
                                       style="width: 100%;"
                                       tal:attributes="id string:${column}_${fieldName}_new;
                                                       name string:${fieldName}.${column}:records;" />
                           </span>
                        </td>
                        <td  class="datagridwidget-manipulator">
                            <img alt="Delete row"
                                 onclick="customMetaTagsFunctions.removeFieldRow(this);return false"
                                 tal:attributes="src string:${portal_url}/delete_icon.gif;" />
                        </td>
                        <td class="datagridwidget-hidden-data">
                            <input type="hidden"
                                   value="template_row_marker"
                                   tal:attributes="name string:${fieldName}.orderindex_:records;
                                                  id string:orderindex__${fieldId};" />
                        </td>
                    </tr>
                </tbody>
            </table>
            <input type="button"
                   class="datagridwidget-add-button"
                   id="datagridwidget-add-button"
                   value="Add new row"
                   tal:attributes="onclick string:customMetaTagsFunctions.addRow('${fieldName}')" />
          </div>
          <div class="formControls"
               tal:define="process_creation request/process_creation|nothing;"
               i18n:domain="plone">
            <input class="context"
                   tabindex=""
                   type="submit"
                   name="form.button.Save"
                   value="Save"
                   i18n:attributes="value"
                   tal:attributes="tabindex tabindex/next;" />
            <input class="standalone"
                   tabindex=""
                   type="submit"
                   name="form.button.Cancel"
                   value="Cancel"
                   i18n:attributes="value"
                   tal:attributes="tabindex tabindex/next;" />
          </div>
        </fieldset>
        <input type="hidden" name="form.submitted" value="1" />
      </form>
    </div>
  </body>
</html>

